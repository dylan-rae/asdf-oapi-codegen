name: Build

on:
  push:
    branches:
      - main
  pull_request:

jobs:
<<<<<<< HEAD
  plugin_test:
    name: asdf plugin test
=======
  test:
    name: template setup test
>>>>>>> f31da0c3fc5a28058f20e5ec6fb81e225e70b1eb
    strategy:
      matrix:
        os:
          - ubuntu-latest
          - macos-latest
    runs-on: ${{ matrix.os }}
    steps:
<<<<<<< HEAD
      - name: asdf_plugin_test
        uses: asdf-vm/actions/plugin-test@v2
        with:
          command: oapi-codegen --version
=======
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Run Template Setup
        run: |
          git config user.name "Foo Bearer"
          ./setup.bash \
            "asdf-foo" \
            "foo --help" \
            "asdf-community" \
            "ASDF Community" \
            "https://github.com/asdf-vm/asdf" \
            "https://asdf-vm.com" \
            "Apache-2.0" \
            "yes"

      - name: Check setup result
        run: |
          set -xe
          ls -la .
          git log
          test ! -d template/
          grep "Apache" LICENSE
          test "main" = "$(git rev-parse --abbrev-ref HEAD)"
          ! git grep -F -e "<YOUR TOOL>" \
                   --or -e "<TOOL HOMEPAGE>" \
                   --or -e "<TOOL REPO>" \
                   --or -e "<TOOL CHECK>" \
                   --or -e "<YOUR NAME>" \
                   --or -e"<YOUR GITHUB USERNAME>"
>>>>>>> f31da0c3fc5a28058f20e5ec6fb81e225e70b1eb
